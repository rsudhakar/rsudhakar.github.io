<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Sudhakar's Blog</title>
    <meta name="viewport" content="width=device-width">
    <link rel="icon" href="/images/favicon.ico" type="image/x-icon"/>

    <!-- syntax highlighting CSS -->
    <link rel="stylesheet" href="/css/syntax.css">
    <link rel="stylesheet" href="/css/fontello.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/global.css">
    <link rel="stylesheet" href="/css/list.css">
    <link rel="stylesheet" href="/css/post.css">
    <link rel="stylesheet" href="/css/drawing_theme.css">

    <script src="/scripts/jquery-1.10.2.js"></script>
    <script src="/scripts/underscore-min.js"></script>
    <script src="/scripts/default.js"></script>
    <script src="/scripts/post.js"></script>
</head>

<body class="drawing_theme">

<div class="site_header">
    <i class="icon icon-art-gallery theme-selector"></i>
    <span class="blogger">Sudhakar Rayavaram</span>
</div>

<div id="post_list">
</div>

<div id="post_backdrop">
    <div id="post_container">
        <div class="left"></div>
        <div class="content">
            <div class="post_heading">
                <div class="date">10 Nov 2010</div>
                <div class="title_section">eval() in Java?</div>
            </div>

            <div class="post">
                <p>Here is the question from my friend (ex-colleague):</p>

<p><strong>“I have a mathematical expression say (45 %2B ((4 – 25) %2B 2)) as a string. How can you evaluate it to find the result using JAVA programming language?”</strong></p>

<p>Well, this is very easy with javascript as it has the powerful eval() function.
But java is static, strongly typed, not-that-flexible language.
So, this cannot be provided as a language feature which leads me to either search for some available libraries or, write my won little library.
If you are reading this post, you know by now what my decision was:) Come on, what’s fun in searching for someone’s work ;) (Well, not always)</p>

<p>So, here it is… This would have been much simpler with dynamic language like Groovy… But, the requirement clearly said JAVA</p>

<p><em>Logic is quite simple. The given input is an infix expression. Use stack and keep pushing all the elements (including braces) till you encounter a closed brace.
Now, popping from the stack till you encounter an open brace will get you an operator and 2 operands.
Evaluate it and push back the result to continue the same logic till the end of the input string.</em></p>

<div class="highlight"><pre><code class="java"><span class="lineno"> 1</span> <span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">rs</span><span class="o">.</span><span class="na">utils</span><span class="o">;</span>
<span class="lineno"> 2</span> 
<span class="lineno"> 3</span>   <span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="lineno"> 4</span>   <span class="kn">import</span> <span class="nn">java.util.Stack</span><span class="o">;</span>
<span class="lineno"> 5</span>   <span class="kn">import</span> <span class="nn">java.util.regex.Matcher</span><span class="o">;</span>
<span class="lineno"> 6</span>   <span class="kn">import</span> <span class="nn">java.util.regex.Pattern</span><span class="o">;</span>
<span class="lineno"> 7</span> 
<span class="lineno"> 8</span>   <span class="kd">public</span> <span class="kd">class</span> <span class="nc">Evaluator</span> <span class="o">{</span>
<span class="lineno"> 9</span> 
<span class="lineno">10</span>      <span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">eval</span><span class="o">(</span><span class="n">String</span> <span class="n">infixExpression</span><span class="o">)</span> <span class="o">{</span>
<span class="lineno">11</span>          <span class="n">Stack</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">stack</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Stack</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
<span class="lineno">12</span>          <span class="n">String</span> <span class="n">trimmedExp</span> <span class="o">=</span> <span class="n">infixExpression</span><span class="o">.</span><span class="na">replaceAll</span><span class="o">(</span><span class="s">&quot; &quot;</span><span class="o">,</span> <span class="s">&quot;&quot;</span><span class="o">);</span>
<span class="lineno">13</span>          <span class="k">for</span> <span class="o">(</span><span class="n">String</span> <span class="n">c</span> <span class="o">:</span> <span class="n">split</span><span class="o">(</span><span class="n">trimmedExp</span><span class="o">))</span> <span class="o">{</span>
<span class="lineno">14</span>              <span class="k">if</span> <span class="o">(</span><span class="s">&quot;)&quot;</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">c</span><span class="o">))</span> <span class="o">{</span>
<span class="lineno">15</span>                  <span class="k">if</span> <span class="o">(!</span><span class="s">&quot;(&quot;</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">stack</span><span class="o">.</span><span class="na">peek</span><span class="o">()))</span> <span class="o">{</span>
<span class="lineno">16</span>                      <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="n">performOperation</span><span class="o">(</span><span class="n">stack</span><span class="o">.</span><span class="na">pop</span><span class="o">(),</span> <span class="n">stack</span><span class="o">.</span><span class="na">pop</span><span class="o">(),</span>
<span class="lineno">17</span>                              <span class="n">stack</span><span class="o">.</span><span class="na">pop</span><span class="o">())</span> <span class="o">+</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
<span class="lineno">18</span>                      <span class="n">stack</span><span class="o">.</span><span class="na">pop</span><span class="o">();</span> <span class="c1">// remove also the open bracket</span>
<span class="lineno">19</span>                      <span class="n">stack</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
<span class="lineno">20</span>                  <span class="o">}</span>
<span class="lineno">21</span>              <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
<span class="lineno">22</span>                  <span class="n">stack</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
<span class="lineno">23</span>              <span class="o">}</span>
<span class="lineno">24</span>          <span class="o">}</span>
<span class="lineno">25</span>          <span class="k">return</span> <span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">stack</span><span class="o">.</span><span class="na">pop</span><span class="o">());</span>
<span class="lineno">26</span>      <span class="o">}</span>
<span class="lineno">27</span> 
<span class="lineno">28</span>      <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">performOperation</span><span class="o">(</span><span class="n">String</span> <span class="n">operand2</span><span class="o">,</span> <span class="n">String</span> <span class="n">operator</span><span class="o">,</span>
<span class="lineno">29</span>              <span class="n">String</span> <span class="n">operand1</span><span class="o">)</span> <span class="o">{</span>
<span class="lineno">30</span>          <span class="kt">int</span> <span class="n">op1</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">operand1</span><span class="o">);</span>
<span class="lineno">31</span>          <span class="kt">int</span> <span class="n">op2</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">operand2</span><span class="o">);</span>
<span class="lineno">32</span>          <span class="k">switch</span> <span class="o">(</span><span class="n">operator</span><span class="o">.</span><span class="na">toCharArray</span><span class="o">()[</span><span class="mi">0</span><span class="o">])</span> <span class="o">{</span>
<span class="lineno">33</span>              <span class="k">case</span> <span class="sc">&#39;+&#39;</span><span class="o">:</span> <span class="k">return</span> <span class="n">op1</span> <span class="o">+</span> <span class="n">op2</span><span class="o">;</span>
<span class="lineno">34</span>              <span class="k">case</span> <span class="sc">&#39;-&#39;</span><span class="o">:</span> <span class="k">return</span> <span class="n">op1</span> <span class="o">-</span> <span class="n">op2</span><span class="o">;</span>
<span class="lineno">35</span>              <span class="k">case</span> <span class="sc">&#39;*&#39;</span><span class="o">:</span> <span class="k">return</span> <span class="n">op1</span> <span class="o">*</span> <span class="n">op2</span><span class="o">;</span>
<span class="lineno">36</span>              <span class="k">case</span> <span class="sc">&#39;/&#39;</span><span class="o">:</span> <span class="k">return</span> <span class="n">op1</span> <span class="o">/</span> <span class="n">op2</span><span class="o">;</span>
<span class="lineno">37</span>              <span class="k">default</span><span class="o">:</span> <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
<span class="lineno">38</span>          <span class="o">}</span>
<span class="lineno">39</span>      <span class="o">}</span>
<span class="lineno">40</span> 
<span class="lineno">41</span>      <span class="kd">static</span> <span class="n">String</span><span class="o">[]</span> <span class="nf">split</span><span class="o">(</span><span class="n">String</span> <span class="n">exp</span><span class="o">)</span> <span class="o">{</span>
<span class="lineno">42</span>          <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">parts</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
<span class="lineno">43</span>          <span class="n">Pattern</span> <span class="n">pat</span> <span class="o">=</span> <span class="n">Pattern</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="s">&quot;\\d++|\\+|\\-|\\*|/|\\(|\\)&quot;</span><span class="o">);</span>
<span class="lineno">44</span>          <span class="n">Matcher</span> <span class="n">matcher</span> <span class="o">=</span> <span class="n">pat</span><span class="o">.</span><span class="na">matcher</span><span class="o">(</span><span class="n">exp</span><span class="o">);</span>
<span class="lineno">45</span>          <span class="k">while</span> <span class="o">(</span><span class="n">matcher</span><span class="o">.</span><span class="na">find</span><span class="o">())</span> <span class="o">{</span>
<span class="lineno">46</span>              <span class="n">parts</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">matcher</span><span class="o">.</span><span class="na">group</span><span class="o">());</span>
<span class="lineno">47</span>          <span class="o">}</span>
<span class="lineno">48</span>          <span class="k">return</span> <span class="n">parts</span><span class="o">.</span><span class="na">toArray</span><span class="o">(</span><span class="k">new</span> <span class="n">String</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
<span class="lineno">49</span>      <span class="o">}</span>
<span class="lineno">50</span>   <span class="o">}</span></code></pre></div>

            </div>


        </div>
        <div class="right"></div>
    </div>
</div>

<script>
    initPost();
</script>

<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-26664903-1', 'rsudhakar.in');
    ga('send', 'pageview');
</script>
</body>
</html>
